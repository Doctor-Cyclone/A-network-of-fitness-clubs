(()=>{"use strict";const e=function(e){var t=document.getElementById("free_visit_form"),n=document.getElementById("callback_form"),l=document.getElementById("gift");t.style.display="none",n.style.display="none",l&&(l.style.display="none")};var t;(t=document.getElementById("thanks")).addEventListener("click",(function(e){var n=e.target;(n.closest(".close_icon")||n.closest(".close-btn")||n.closest(".overlay"))&&(t.style.display="none")}));const n=function(t){var n=document.createElement("div"),l=document.getElementById(t),o=l.querySelector('[type = "checkbox"]'),c=l.querySelector(".personal-data"),r=l.querySelector(".club"),a=l.querySelector('[value = "mozaika"]'),s=l.querySelector('[value = "schelkovo"]'),i=l.querySelectorAll('[name = "card-type"]'),u=document.getElementById("price-total"),d=l.querySelectorAll("input"),m=document.getElementById("thanks"),y=m.querySelector(".form-content");n.style.color="#FFD11A",n.style.textAlign="center",n.style.fontSize="20px";var v=function(){d.forEach((function(e){e.value=""})),r&&(a.checked=!1,s.checked=!1),i&&i.forEach((function(e){e.checked=!1})),u&&(u.innerHTML=0),o&&(o.checked=!1)};l.addEventListener("submit",(function(e){e.preventDefault();var t=function(){var e=document.createElement("div");e.classList.add("error-message"),e.style.cssText="color: red; font-size: 16px; margin-top: 15px",c.append(e)},n=function(){for(var e=0;e<i.length;e++){if(i[e].checked){a.checked||s.checked||o.checked?o.checked?a.checked||s.checked?(l.querySelector(".error-message").remove(),f()):l.querySelector(".error-message").textContent="Необходимо выбрать клуб!":l.querySelector(".error-message").textContent="Необходимо подтвердить согласие на обработку данных!":l.querySelector(".error-message").textContent="Необходимо выбрать клуб и подтвердить согласие на обработку данных!";break}l.querySelector(".error-message").textContent="Необходимо выбрать кол-во месяцев!"}};if(o&&r){if(l.querySelector(".error-message"))return void n();t(),n()}else o?o.checked?l.querySelector(".error-message")?(l.querySelector(".error-message").remove(),f()):f():(t(),l.querySelector(".error-message").textContent="Необходимо подтвердить согласие на обработку данных!"):r&&(a.checked||s.checked?l.querySelector(".error-message")?(l.querySelector(".error-message").remove(),f()):f():(t(),l.querySelector(".error-message").textContent="Необходимо выбрать клуб!"))}));var f=function(){l.appendChild(n),n.innerHTML="Загрузка...";var t=new FormData(l),o={};t.forEach((function(e,t){o[t]=e})),p(o).then((function(t){if(200!==t.status)throw new Error("status network not 200");m.style.display="block",y.innerHTML='<h4>Спасибо!</h4>\n                        <p>Ваша заявка отправлена. <br> Мы свяжемся с вами в ближайшее время.</p>\n                        <button class="btn close-btn">OK</button>',n.textContent="",v(),setTimeout((function(){e(),m.style.display="none"}),2e3)})).catch((function(e){console.log(e),m.style.display="block",y.innerHTML='<h4>Упс!</h4>\n                        <p>Что-то пошло не так. <br> Ваша заявка не отправлена.</p>\n                        <button class="btn close-btn">OK</button>',n.textContent="",v()}))},p=function(e){return fetch("./server.php",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})}};var l,o,c,r,a,s,i,u,d,m,y,v,f,p,g,h,b,k,S,E,q,L,w,x;x=document.querySelector(".club-select").querySelector(".clubs-list ul"),window.addEventListener("click",(function(e){var t=e.target;if(t.closest(".club-select"))"block"===x.style.display?x.style.display="none":x.style.display="block";else if(!t.closest(".clubs-list")){if("block"!==x.style.display)return;x.style.display="none"}})),E=document.getElementById("free_visit_form"),q=document.getElementById("callback_form"),L=document.getElementById("gift"),w=document.querySelector(".fixed-gift"),window.addEventListener("click",(function(t){var n=t.target;n.hasAttribute("type")||(n.classList.contains("open-popup")?E.style.display="block":n.classList.contains("callback-btn")?q.style.display="block":n.closest(".fixed-gift")?(w.style.display="none",L.style.display="block"):(n.closest(".close-form")||n.closest(".overlay")||n.closest(".close-btn"))&&e())})),p=document.querySelector(".main-slider"),g=p.querySelectorAll(".slide-text"),h=p.querySelectorAll(".slide"),b=0,k=function(){h[b].style.display="none",++b>=h.length&&(b=0),h[b].style.display="block"},S=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:2e3;f=setInterval(k,e)},g.forEach((function(e){e.addEventListener("mouseover",(function(){clearInterval(f)})),e.addEventListener("mouseout",(function(){S(2e3)}))})),S(2e3),function(){var e,t=document.querySelector(".gallery-slider"),n=t.querySelectorAll(".slide"),l=document.querySelector(".slider-dots"),o=[],c=0;!function(){for(var e=0;e<n.length;e++){var t=document.createElement("li"),c=document.createElement("button");t.classList.add("dot"),c.classList.add("dot-btn"),o.push(t),t.append(c),l.append(t)}}(),o[0].classList.add("slick-active");var r=t.querySelectorAll(".dot"),a=function(e,t,n){e[t].classList.remove(n)},s=function(e,t,n){e[t].classList.add(n)},i=function(){a(n,c,"slide-active"),a(r,c,"slick-active"),++c>=n.length&&(c=0),s(n,c,"slide-active"),s(r,c,"slick-active")},u=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:2e3;e=setInterval(i,t)};t.addEventListener("click",(function(e){e.preventDefault();var t=e.target;t.matches(".arrow-btn, .dot")&&(a(n,c,"slide-active"),a(r,c,"slick-active"),t.matches(".next")?c++:t.matches(".prev")?c--:t.matches(".dot")&&r.forEach((function(e,n){e===t&&(c=n)})),c>=n.length&&(c=0),c<0&&(c=n.length-1),s(n,c,"slide-active"),s(r,c,"slick-active"))})),t.addEventListener("mouseover",(function(t){(t.target.matches(".arrow-btn")||t.target.matches(".dot"))&&clearInterval(e)})),t.addEventListener("mouseout",(function(e){(e.target.matches(".arrow-btn")||e.target.matches(".dot"))&&u(3e3)})),u(3e3)}(),function(){var e=document.querySelector(".services-slider"),t=e.querySelector(".services-slider-container"),n=(e.querySelector("slide"),0);e.addEventListener("click",(function(e){e.preventDefault();var l=e.target;l.matches(".next")?((n+=226)>1130&&(n=0),t.style.left=-n+"px"):l.matches(".prev")&&((n-=226)<0&&(n=1130),t.style.left=-n+"px")}))}(),function(){var e,t=document.querySelector(".popup-menu"),n=document.querySelector(".menu-button"),l=document.querySelector(".top-menu"),o=document.querySelector(".head").clientHeight,c=window.getComputedStyle(n).display;e=function(){window.scrollY>o?l.classList.add("fixed-menu"):l.classList.remove("fixed-menu")},window.onscroll=function(){"block"===c&&e()},window.addEventListener("resize",(function(){var t=window.getComputedStyle(n).display;window.onscroll="block"===t?function(){e()}:function(){l.classList.remove("fixed-menu")}})),e();var r=function(){"block"===t.style.display?t.style.display="none":t.style.display="block"};n.addEventListener("click",r),t.addEventListener("click",(function(e){var t=e.target;(t.closest(".close-menu-btn")||"A"===t.tagName)&&r()}))}(),(v=document.getElementById("totop")).style.display="none",v.addEventListener("click",(function(){window.scrollTo(0,0),v.style.display="none"})),window.onscroll=function(){document.documentElement.scrollTop>=700?v.style.display="block":v.style.display="none"},i=document.querySelectorAll('[name = "name"]'),u=document.querySelectorAll('[name = "phone"]'),d=function(e,t){"7"!==e[0]&&"8"!==e[0]&&(e.length>11||e.length<7)?t.setCustomValidity("Номер телефона должен начинаться с 8 или 7!\n                        Вы ввели ".concat(e.length," цифр. Количество цифр должно быть в диапазоне от 7 до 11!")):e.length>11||e.length<7?t.setCustomValidity("Вы ввели ".concat(e.length," цифр. Количество цифр должно быть в диапазоне от 7 до 11!")):"7"!==e[0]&&"8"!==e[0]&&t.setCustomValidity("Номер телефона должен начинаться с 8 или 7!")},m=function(e){e.addEventListener("blur",(function(){if(e.value=e.value.replace(/\-{2,}/g,"-"),e.value=e.value.replace(/\s{2,}/g," "),e.value=e.value.replace(/\+{2,}/g,"+"),e.value=e.value.replace(/\({2,}/g,"("),e.value=e.value.replace(/\){2,}/g,")"),e.value=e.value.replace(/^[\s]+|[ \s]+$/,""),e.value=e.value.replace(/^[/-]+|[/-]+$/,""),"name"===e.getAttribute("name"))if(/\D{2}/g.test(e.value)){var t=e.value.split(" ").map((function(e){return e.charAt(0).toUpperCase()+e.substring(1).toLowerCase()}));e.value=t.join(" ")}else e.value="";if("phone"===e.getAttribute("name")){e.value=e.value.replace(/\-{1,}/g,""),e.value=e.value.replace(/\s{1,}/g,""),e.value=e.value.replace(/\+{1,}/g,""),e.value=e.value.replace(/\({1,}/g,""),e.value=e.value.replace(/\){1,}/g,"");var n=e.value.split("");/\+?[78]([-()]*\d){7,10}/g.test(e.value.replace(/\s{1,}/g,""))?(e.setCustomValidity(""),d(n,e)):d(n,e)}}))},y=function(e){"name"===e.getAttribute("name")?(e.addEventListener("input",(function(){e.value=e.value.replace(/[^а-яё\- ]/gi,"")})),m(e)):(e.addEventListener("input",(function(){e.value=e.value.replace(/[^-()\d\+ ]/g,"")})),m(e))},i.forEach((function(e){y(e)})),u.forEach((function(e){y(e)})),document.querySelector(".price")&&(l=document.querySelector('[name = "promoСode"]'),o=document.getElementById("price-total"),c=document.querySelectorAll('[name = "card-type"]'),r=document.getElementById("card_order"),a=document.querySelectorAll('#card_order [name = "club-name"]'),s=function(e,t){fetch(t).then((function(e){return e.text()})).then((function(t){!function(e,t){var n=(new DOMParser).parseFromString(e,"text/html").querySelector(".cards-types"),c=n.querySelectorAll('[name = "card-type"]'),r=n.querySelectorAll("label");c.forEach((function(e){e.value===t&&r.forEach((function(t){if(t.getAttribute("for")===e.getAttribute("id")){var n=t.querySelector(".cost").textContent,c=n.substr(0,n.length-1);"ТЕЛО2020"===l.value?(c-=Math.ceil(c/100*30),o.innerHTML=c):o.innerHTML=c}}))}))}(t,e)}))},r.addEventListener("change",(function(){a.forEach((function(e){e.checked&&("mozaika"===e.value?c.forEach((function(e){e.checked&&s(e.value+"s","mozaika.html")})):c.forEach((function(e){e.checked&&s(e.value+"s","schelkovo.html")})))}))}))),n("banner-form"),n("card_order"),n("footer_form"),n("form1"),n("form2")})();